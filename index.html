<!DOCTYPE html>
<html>
  <head>
    BoozeCruise
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <link href="index.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Slots</h1>

    <div class="slots">
      <h1 id="slots">❓|❓|❓|❓|❓|❓|❓|❓|❓|❓|❓</h1>
      <div class="balance">
        <h3>Balance:</h3>
        <h2 id="balance">100</h2>
      </div>

      <div class="form-group imput">
        <label>Bet:</label>
        <input class="form-control" id="bet" type="number" type="number" value="50" />
      </div>
      <br />
      <button class="btn btn-success" onclick="slots(document.getElementById('bet').value)">
        Click Me
      </button>
    </div>
    <div>
      <h1>How to play</h1>
      <ul>
        <li>Odds for each item are 6:1</li>
        <li>A 🍒 in any location is worth 50% of your bet.</li>
        <li>
          A 🍒 in the beginning of a row plus any directly consecutive 🍒s will increase your prize to the power of the
          amount of cherrys in a row.
        </li>
        <li>
          The amount that you bet directly impacts how many emojis are displayed in a row.
          <ul>
            <li>01-30 = 🍒|🍒|🍒</li>
            <li>31-40 = 🍒|🍒|🍒|🍒</li>
            <li>41-50 = 🍒|🍒|🍒|🍒|🍒</li>
            <li>51-60 = 🍒|🍒|🍒|🍒|🍒|🍒</li>
            <li>61-70 = 🍒|🍒|🍒|🍒|🍒|🍒|🍒</li>
            <li>71-80 = 🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒</li>
            <li>81-90 = 🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒</li>
            <li>91-100 = 🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒|🍒</li>
          </ul>
        </li>
      </ul>
    </div>
  </body>

  <script>
    const symbols = ["🍒", "🛳", "🏝", "🌊", "☀️"];
    let rolls = [
      {symbol: "🍒", count: 0},
      {symbol: "🛳", count: 0},
      {symbol: "🏝", count: 0},
      {symbol: "🌊", count: 0},
      {symbol: "☀️", count: 0},
    ];
    let plays = 0;
    // const symbols = ["🍒", "🛳", "🏝", "🌊", "☀️", "⚓️"];

    const slots = (bet) => {
      bet = parseInt(bet, 10);
      halfBet = Math.round(bet / 2);
      let odds = 0;
      if (bet <= 30) {
        odds = 3;
      } else if (bet <= 100) {
        odds = Math.ceil((bet + 1) / 10);
      } else {
        odds = 10;
      }
      let balance = Number(document.getElementById("balance").innerHTML) - bet;
      console.log("BALANCE = ", balance);

      document.getElementById("balance").innerHTML = balance;
      const house = new Array(odds);
      for (let i = 0; i < odds; i++) {
        const symbol = symbols[Math.floor(Math.random() * symbols.length)];
        house[i] = symbol;
        for (let roll of rolls) {
          if (roll.symbol === symbol) {
            roll.count++;
            break;
          }
        }
      }
      plays++;
      console.log(`${plays} times played`);
      console.log(rolls);

      const print = () => {
        for (let i = 0; i < odds; i++) {
          setTimeout(function () {
            document.getElementById("slots").innerHTML = house.reduce(
              (msg, symbol, j) =>
                msg +
                (i >= j ? (j === house.length - 1 ? symbol : symbol + "|") : j === house.length - 1 ? "❓" : "❓|"),
              ""
            );
          }, 1000 * i);
        }
        setTimeout(() => {
          prizes();
        }, (odds - 1) * 1000);
      };

      const prizes = () => {
        i = 0;
        prize = house.reduce((prize, symbol) => prize + (symbol === "🍒" ? halfBet : 0), 0);
        let power = 1;
        while (house[i] === "🍒") {
          power += 0.1;
          i++;
        }
        prize = Math.ceil(Math.pow(prize, power));
        document.getElementById("balance").innerHTML = balance + prize;
        console.log(`Prize: ${prize}`);
        console.log(`Bet: ${bet}`);
        console.log(`Half Bet: ${halfBet}`);
        // if (house[i] === "🍒") {
        //   document.getElementById("balance").innerHTML = balance + parseInt(bet, 10);
        // }
      };

      const bonus = () => {
        if (house) {
          console.log("Hello");
        }
      };

      print();
    };
  </script>
</html>
